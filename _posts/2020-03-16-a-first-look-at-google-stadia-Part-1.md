---
layout: post
title: 初识谷歌 Stadia（上篇）
category: 计算机
tags: [计算机, 软件]
---


----------
Stadia听起来确实像是游戏的未来。但它能达到宣传的效果吗？继续读下去，获取信息，让我们知道你的想法！


----------
30多年来，游戏开发者大会(GDC)一直是技术专家们的主要日程，而GDC 2019也没有让人失望。谷歌抢尽风头，宣布了备受期待的游戏服务：Stadia。虽然谷歌确实提供了许多关于新的流媒体服务的雄心勃勃的细节，但也有一些信息，比如价格和实现细节，让游戏界的一些主要声音犹豫不决。

在这篇由两部分组成的文章中，我们将涵盖我们目前所知道的关于谷歌Stadia的细节，包括来自2019年GDC主题演讲的Stadia信息、数字铸造现场体验以及谷歌在周二GDC发布会后对游戏新闻媒体进行的各种采访。本文的第一部分将关注Stadia背后的远景和概念，以及我们目前了解的关于服务的规范。本文的第二部分将继续介绍Stadia的特性、Stadia控制器以及作者对其可行性和未来发展方向的个人看法。

## 愿景

无论是千年前的球类游戏，还是今天最先进的电子游戏，其基本元素无非：玩家、观众和开发者，谷歌对Stadia的愿景则植根于这些游戏的基本元素。从最早的体育赛事开始，游戏的这三个方面就变得至关重要，随着互联网的出现，游戏、观看和开发的障碍几乎消失殆尽，这三个方面也变得更加重要。

这些基础，加上谷歌支持的平台，为创造一个完整的游戏体验创造了近乎完美的条件。谷歌已经支持通过YouTube进行游戏的直播，但是对于观众来说还是有一些固有的摩擦。用户可能正在观看某人玩游戏，但他们自己不能加入乐趣。即使他们购买了游戏，也需要观看者在参与乐趣之前下载并安装游戏。谷歌Stadia的目标是消除这种摩擦，允许任何人在几秒钟内在任何地方开始玩游戏：不安装、不下载、不使用第三方软件。只是马上玩个游戏。

这一愿景是通过整合YouTube和Stadia而实现的，YouTube为观众提供了通过直播体验游戏的平台，而Stadia为玩家提供了参与游戏的平台，而开发人员则创造了新的游戏。根据菲尔·哈里森(谷歌的副总裁)：
> (Stadia)专注于游戏玩家，它受到了开发者的启发，并被YouTube的创建者加以放大。

虽然这一愿景是合理的，并且触及了游戏的基本原理，但它仍然存在一个实际的障碍:让开发人员参与进来。现代游戏的主要问题之一是由于硬件的限制而限制了开发者的想象力。如果开发者想要创造一款拥有复杂细节和多玩家的开放世界游戏，这种幻想可能在现代硬件上无法实现。反过来，创造者倾向于减少他们的工作范围，并调整他们的想象力以满足当前游戏平台的现实约束。

谷歌希望改变这一点。为了更好地支持游戏开发者，谷歌研究了对开发者来说最重要的是什么，并得出结论，Stadia需要三个组件来释放开发者的全部潜力：

   - **创造：**释放无限的创造力。
   - **规模：**达到尽可能大的规模。
   - **连接：**让人们更容易地连接游戏。

这三个点是视距的核心，每一个特征都一致地反映了这一视觉。除了这些租户，谷歌还强调，游戏应该对所有人开放。用首席执行官桑达尔·皮查伊的话说：
   
> 当我们说每个人，我们是指每个人。这是我们公司最令人鼓舞的价值观之一。无论是Android、Chrome还是AI，我们都非常认真地想让所有人都能使用我们的技术。

尽管这一愿景雄心勃勃，但谷歌是少数几家有能力实现为玩家、观众和创造者创造一个无所不包的平台的公司之一，同时确保这个平台对每个人都是真正可访问的。

## 概念

Stadia的核心是云计算。几乎以相同的方式，云计算建立了一个环境中，程序员可以创建应用程序没有limits-programmers看到一个几乎无限的资源池，不管背后的物理拓扑或编排scenes-Stadia利用谷歌的数据中心来创建一个基于云计算的游戏体验。这种方法意味着不是购买游戏——无论是物理上还是数字上——安装游戏，然后让游戏在系统上本地可用，而是在一个计算节点(或一组计算节点)上执行游戏，并流到玩家的设备上。

## 流媒体

虽然视频流媒体(如Netflix或Hulu)并不是什么新鲜事物，但游戏流媒体却是一个完全不同的领域。通常，视频流数据是单向的，与流提供商(即。向客户端设备提供视频数据。在游戏流媒体中，数据是双向的，输入来自于玩家和提供商流媒体的视听(AV)数据。玩家输入和AV数据之间的这种因果关系意味着AV数据不能被预先计算或压缩。相反，提供商必须在收到玩家的输入后实时计算AV数据。

理论上，如果玩家和视距网络之间有足够快的连接，并且视距网络的计算速度足够快，那么玩家的输入就可以被发送到视距网络，用来计算游戏的AV变化，而不会产生任何问题。生成的AV数据反映了这些变化，然后从Stadia网络发送回球员的设备：

![stadia-network.png-14kB][1]

在当今相互连接的游戏世界中，大部分最受欢迎的游戏都是大型多人在线(MMO)游戏(如Fortnite或Apex: Legends)，这具有许多优势。目前，玩家购买一个单独的游戏控制台，这个控制台连接到服务器或其他控制台，数据通过internet流动，创建一个相互连接的控制台网络。例如，在多人游戏场景中，一个玩家可以移动他的角色，这些数据要么发送到服务器，要么直接发送到其他玩家，以反映他或她在其他玩家的控制台上的位置变化：

![traditional-multiplayer.png-39.8kB][2]

Stadia完全改变了这种拓扑结构，将方案的控制台部分绘制为单一的本地化网络。这意味着一个名为Stadia instance的控制台可以与另一个实例通信，而无需通过公共internet发送数据。相反，每个Stadia实例与同一网络中的其他实例直接通信：

![stadia-topology.png-25.3kB][3]

在需要它的游戏中，游戏的客户端和服务器部分位于同一个网络中。这意味着客户机可以直接访问服务器。根据谷歌的说法，这将导致多人游戏从最初的100个玩家(如典型的《battle-royale mmo》)发展到数万个并发玩家。哈里森的话(引用自《欧洲玩家》)：

> 在我们的平台上，客户端和服务器在相同的架构中，因此，从历史上看，你谈论的是客户端和服务器之间的ping时间的毫秒数，在我们的架构你谈论微秒在某些情况下,这使我们能够扩大采用极为戏剧化的方式“自杀”的玩家数量,可以结合在一个单一的实例和明显的例子就是大逃杀从数百到数千玩家甚至成千上万的玩家。这是否有趣是一个不同的争论，但从技术上来说，这只是一个你可以想象的头条新闻。

与传统游戏拓扑相比，这种协同定位带来了四个主要优势：

 1. **可预测和低延迟：** 由于数据在同一网络中的实例之间流动，延迟明显更小，并且可以进行统计预测。
 2. **可靠的连接：** 将实例放在一起意味着实例之间的连接极不可能被切断。
 3. **数据安全：** 流量只通过专用的谷歌网络，而非公共互联网，因此是安全的(假设网络没有被攻破);这意味着从理论上消除黑客、欺骗和盗版行为。
 4. **可伸缩性：** Stadia实例的云能力允许分配更多或更少的资源来支持单个游戏实例或一组玩同一款游戏的玩家。

虽然这些优势对于许多开发者来说是一个突破，但是这种方案仍然有一个基本的缺点：从玩家到视距网络的连接。即使在单人游戏中，玩家也必须与视距网络保持连续的网络连接，才能将游戏流到他或她的设备上。更重要的是，这个连接必须足够快才能以可接受的质量播放游戏。在实践中，这可能是一个严重的问题，因为许多互联网连接都远非理想。

Stadia的概念很适合最近的mmo风格的游戏，但这些并不是目前市场上唯一成功的游戏类型。许多最流行的游戏,包括红色死亡救赎2(2300万售价写作),蜘蛛侠在前4个月销售(超过900万),塞尔达传说:狂野的气息(1170万售价写作),和超级马里奥奥德赛(1380万售价写作)主要是单机游戏。虽然多人游戏已经登上了现代游戏的宝座，但单人游戏绝不是过去的遗迹。除非Stadia能够正确地管理播放器和谷歌数据中心之间的延迟，否则本地控制台仍然将占据一席之地，特别是在单玩家游戏中。

## 可访问性

为了方便所有人使用，谷歌确保了Stadia是真正跨平台的。根据Harrison的说法，开发者将能够创建一个单独的代码基，并且可以在：

 1. 台式电脑
 2. 笔记本电脑
 3. 电视
 4. 平板电脑
 5. 手机

这种交叉兼容性是由视距的流特性所决定的。不像在主机上那样下载代码并在设备上执行，Stadia将游戏流送到任何能够接受流并提供玩家输入的设备上(来自Stadia keynote的图像)。

![cross-platform.png-1130.4kB][4]

从概念上讲，这是迈向游戏未来的一次巨大飞跃。游戏开发人员不再需要在不同的主机上创建和支持单个游戏的多个版本。相反，开发人员现在可以创建单个游戏和玩家，并在各种设备上进行游戏。为了把这个概念从梦想变成现实，Stadia需要非凡的网络和硬件。

## 实现

在2018年，谷歌推出了它的项目流测试，在这个测试中，玩家可以将《刺客信条:Oddessey》流到任何一个Chrome浏览器上。虽然人们的期望很低，但结果却令人印象深刻:谷歌能够将一款视觉密集型游戏传输到web浏览器，同时仍能保持1080p和60帧/秒(fps)的分辨率。虽然报告了一些图像质量问题，但总的来说，测试是非常成功的。虽然谷歌已经停止了项目流程，但在beta测试建立的基础上还会有更大的东西出现，这并不是一个很好的秘密。

## 视觉效果

Stadia是继任者和谷歌承诺带来更多的比可用于项目流。具体来说，Majd Bakar(谷歌的副总裁)在主题演讲中声称，Stadia将能够通过高动态范围(HDR)渲染和环绕声以每秒60帧的速度播放4k格式的游戏。虽然这对流媒体服务来说是一个令人震惊的承诺，但巴卡尔进一步表示，Stadia已经在展望未来，未来将能够以8k分辨率和120+ fps播放比赛。

此外，Stadia可以同时流到YouTube在尽可能高的分辨率，即使球员没有看到他或她自己的分辨率，由数字铸造证实。例如，如果玩家和Stadia之间的连接很弱，只能支持1080p，游戏画面仍然可以以4k分辨率流到YouTube上。玩家可以选择私下存档这个同步的YouTube流，或与朋友或整个世界分享这个流。

![simultaneous-stream-to-youtube.png-515.7kB][5]

虽然Stadia承诺的AV质量令人震惊，但也存在一些权衡。高图像分辨率并不一定意味着高图像质量。在《刺客信条:Oddessey》中，Stadia与Xbox One X在运行相同场景时的图像质量有明显的不同(在原始的《Digital Foundry》视频中可以更清楚地看到细节上的减少)：

![visual-comparison-xbox-one-x.png-1200.9kB][6]

不过，有两件事要记住。首先，提供给Digital Foundry的Stadia流仅以30帧/秒的速度传输1080p(就像Project stream的情况一样)，当Stadia正式启动时，它将提高到每秒60帧/秒的4k分辨率。其次，这个测试在谷歌网络连接的谷歌Pixelbook上运行，所以这个流可能在理想的条件下。谷歌不可能允许Digital Foundry进行这样的测试，而不向Digital Foundry提供最佳的可能方案。

Stadia公司的视频流比Project stream公司的视频流延迟少(低7.5%)，但仍比Xbox One X的延迟多11毫秒(高13.5%)。再一次,这些数字并不是最终有望提高发射,但有必要记住流4 k甚至8 k的形象并不意味着质量的图像或延迟将与本地系统,可以生成相同的图像分辨率。

## 网络

为了维持这样一个雄心勃勃的视觉流，谷歌将利用其数据中心网络。根据Bakar的说法，这个网络由7500多个边缘节点组成，这些节点由谷歌光纤连接。此外，Pichai声称谷歌服务器遍布全球19个地区和200多个国家，这对于在北美以外地区玩游戏时的连接局域性来说是个好兆头。虽然谷歌没有提供关于它的网络的细节，Bakar声称谷歌已经私下测试这个流媒体技术很多年了，它是安全的，至少在目前，庞大的谷歌网络不会成为视距生态系统的瓶颈。

## 节点

视距网络的核心是视距节点。这个节点有很多事情要做:它必须接受来自互联网上的玩家的输入，根据特定的游戏和接收到的输入生成AV数据，然后将这些AV数据发送回玩家。更重要的是，它必须在一个足够紧凑的窗口中实现这一点，以便在未来支持4k分辨率(60帧/秒)和8k分辨率(120帧/秒)(图片来自Stadia keynote)。

![stadia-node.png-1078.2kB][7]

欧洲玩家能够从谷歌获取Stadia节点的规格，并就这些规格采访了Harrison和Bakar。需要注意的是，这些规范是第一代视距，从谷歌看来，视距的硬件将随着技术的成熟而发展。根据eurogamer，每个节点都有以下硬件规格(所有规格数据均来自eurogamer)：

 1. **中央处理器(CPU)：** 自定义CPU的频率为2.7 GHz，不过谷歌并没有透露厂商。谷歌确实确认了CPU是服务器级的，但拒绝透露有多少物理内核或线程可供开发人员使用。
 2. **图形处理单元(GPU)：** AMD提供的自定义GPU，具有10.7 teraflops (TF)的计算能力和56个计算单元。这个频率和单元计数的结果是一个大约1495 MHz的时钟速度。谷歌还证实，虽然GPU可以被虚拟化，但整个10.7 TF是专用于一个单一的播放器实例，但未能说明GPU是使用AMD的Vega还是Navi架构。Euro Gamer推测它可能正在使用Vega，因为这种GPU与消费者Radeon RX Vega 56的规格非常匹配。
 3. **内存：** 16gb的高带宽内存(HBM) 2在CPU和GPU之间共享，尽管CPU和GPU不是集成在一个芯片上。HBM2的带宽为484gb /s，这使得欧洲的游戏玩家进一步相信GPU与Radeon RX Vega 56有关，因为Vega 56具有相同的HBM2吞吐量，在800mhz下具有2048位的接口。
 4. **存储：** pb级固态硬盘(SSD)存储。谷歌没有精确地指定每个开发人员可以使用多少存储空间。然而，众所周知，云网络(如谷歌的数据中心)的存储速度比许多家庭控制台的存储速度要快得多。

## 图形处理单元

GPU性能(10.7 TF)尤其引人关注，因为谷歌声称它比PlayStation (PS) 4 Pro和Xbox One X加起来还要强大。从表面上看，这是事实，但它并不能说明全部。谷歌将其最新的GPU技术与分别于2016年11月和2017年11月发布的游戏机相比较。当索尼和微软发布最新一代游戏机的规格时，Stadia和这些游戏机之间的差距可能会消失。由于AMD还为PS4 Pro和Xbox One提供GPU，我们预计性能数据将更接近Stadia，架构也将更符合Stadia GPU (Stadia keynote提供的图像)。

![spec-comparison.png-712.9kB][8]
 
其次，需要强调的是，原始计算能力不一定会带来更好的图像质量。以PS4 Pro和Xbox One X为例，图像是由GPU生成并直接显示在电视等输出设备上的。对于Stadia, GPU生成的图像必须经过压缩并通过网络发送到球员的设备。虽然图像是在源头(即， Stadia节点)可能具有更高的质量，用户看到的最终结果可能不反映该质量。从本质上讲，可能需要更多的GPU计算能力来弥补压缩和传输所带来的质量损失。

与传统的控制台gpu相比，Stadia gpu确实有一个优势:它们是可伸缩的。虽然PS4 Pro或Xbox One X受到物理控制台中包含的资源的限制，但Stadia gpu可以桥接并并行执行。正如在Stadia keynote中演示的那样，从一个GPU到运行同一场景的一对GPU的飞跃是相当引人注目的：

![single-and-multi-gpu.png-1643.8kB][9]

归根结底，玩家在设备上看到的图像质量才是最重要的。目前，我们还没有足够的信息来确定多GPU游戏和增加的GPU计算能力将如何转化为积极的玩家体验，但是谷歌和AMD已经在Stadia背后投入了一些强大的计算能力——严格地从技术角度来说——其规格令人印象深刻。

## 存储

当前的几代游戏机，特别是蓝光碟片上的PS4和Xbox one商店游戏，读取速度较慢。即使游戏是在本地安装的，或者是购买并下载的，硬盘也是传统的旋转硬盘(HDD)。使用HDD意味着对存储器的读写是一个相对较慢的任务:HDD要求从旋转磁盘读取数据，而ssd只需以与内存相同的方式读取数据。此外，云网络中的存储控制器也比自包含系统(如家庭控制台)中的存储控制器快得多。

即使在非硬盘存储的系统上，比如任天堂的交换机，墨盒存储也是很贵的，而且只能少量供应。拥有pb级的存储意味着游戏开发者可以快速读写存储，而不必担心繁琐的任务，比如将复杂的压缩压缩到一个小型的安全数字(SD)卡上，或者在容量更大的SD卡上花费大量金钱。

家庭控制台的存储架构和云之间的区别不是理论上的，玩家可以清楚地感觉到。Digital Foundry用Stadia和Xbox One X进行了测试，在两个系统上加载了相同的场景。Stadia版本在6.6秒内加载了场景，而Xbox One X在24.4秒内加载了相同的场景(是Digital Foundry公司的2.7倍长图像)。

![loading-speed.png-1022.7kB][10]

存储是云计算可以显著胜过家用游戏机的一个领域，尤其是加载大量数据，比如一章的开头或者世界的大片区域。虽然在GPU性能上还没有定论，但就存储性能而言，Stadia无疑是赢家。

## 开发人员工具

为了让Stadia在游戏世界获得吸引力，它必须吸引开发商。除了上面描述的好处之外，最明显的方法是确保从当前的项目到Stadia项目的转换是尽可能轻松的。更复杂的是，将现有的游戏移植到Stadia必须尽可能的无害。为了促进这一转变，视距视距处支持下列各点：

 1. **著名的开源框架：** Stadia使用Debian，这是一个Linux发行版，很多程序员都很熟悉它。Stadia还使用Vulkan，这是一种图形和计算应用程序编程接口(API)，由谷歌为云本地游戏定制。
 2. **最流行的游戏引擎和工具：** Stadia同时支持最流行的两个游戏开发引擎Unreal和Unity，并支持第三方工具，如Havok、RenderDoc、Visual Studio、LLVM、AMD Radeon GPU Profiler、IncrediBuild、Umbra 3、FaceFX和智能音乐系统。谷歌还声称它正在不断地添加新的开发工具。

谷歌还提供了一个定制的软件开发工具包(SDK)，其中包括用于执行日常任务的api，例如保存游戏、协调多人游戏职责以及暂停和恢复游戏。虽然谷歌没有透露其开发工具的全部内容，但除了针对已注册的Stadia开发者的游戏外，谷歌还提供了Stadia Developer的网站，开发者可以在该网站上申请开发并开始建造Stadia games。请注意，选择是有限的，应用程序的过程是相对复杂的(谷歌警告开发人员：请记住，我们将在2019年夏季和以后向选定的一些开发人员推出开发工具包)。

## 玩家需求

除了互联网连接和兼容的设备外，我们目前还不太清楚一个球员需要多大的球场。任何游戏流媒体服务最明显的问题之一是:流媒体提供商所需的最低连接速度是多少?在哈里森的采访中，Kotaku问谷歌的执行官什么是球场的最低速度。Harrison说，可以理解，最低速度随所提供的服务水平而变化：

- 每秒60帧的1080p：每秒25兆比特(Mb/s)
- 每秒60帧的4k：30 Mb/s

1080p的数值是基于项目流程beta测试的结果。虽然4k图像(4096x2160)比1080p图像(1920x1080)大得多，但流媒体和压缩方面的显著改进使Stadia只需要额外的5mb /s就可以传输4k图像(与项目流媒体中的1080p相比)。Harrison声称实际所需的连接速度可能会更低，并表示：

> 我们的用量比这个少，但那是我们的推荐限量……

我们不知道连接速度是否会影响图像质量。（例如：更少的压缩和更高的质量为更高的连接速度）；我们也不知道一段时间内玩一款游戏所需要的平均吞吐量。除了连接速度，我们不知道其他的服务要求，除了电视上的播放需要Chromecast，正如哈里森所说。哈里森解释说，为了达到Chromecast，玩家必须使用Stadia controller(在下一篇文章中详细讨论)。然而，玩家可以在PC上自由使用任何usb兼容的控制器。

本文援引[DZone][11]，翻译：Louis，原文链接：[https://dzone.com/articles/a-first-look-at-google-stadia][12]
 
 


  [1]: http://static.zybuluo.com/gamedebug/v8i4ed42ypr4mbnoizf8nsno/stadia-network.png
  [2]: http://static.zybuluo.com/gamedebug/anpt5euin4gfh2a72au381q9/traditional-multiplayer.png
  [3]: http://static.zybuluo.com/gamedebug/h2y7q18n0cqzpawufdwyy7pz/stadia-topology.png
  [4]: http://static.zybuluo.com/gamedebug/ncg7xf89mmbkqei309r23nyr/cross-platform.png
  [5]: http://static.zybuluo.com/gamedebug/p3ybkpso51ysjmwkuxxqtjul/simultaneous-stream-to-youtube.png
  [6]: http://static.zybuluo.com/gamedebug/q8z01x7eo2l0ckpuk17vxpzv/visual-comparison-xbox-one-x.png
  [7]: http://static.zybuluo.com/gamedebug/v46bkiqajcuqxdl7htab2ext/stadia-node.png
  [8]: http://static.zybuluo.com/gamedebug/vktn6oj532mpz0nnlf1b378z/spec-comparison.png
  [9]: http://static.zybuluo.com/gamedebug/zj3mzj6gtcjbqfkyb2mk2dhv/single-and-multi-gpu.png
  [10]: http://static.zybuluo.com/gamedebug/qx52z3gs7gtut2toydz68xat/loading-speed.png
  [11]: https://dzone.com/
  [12]: https://dzone.com/articles/a-first-look-at-google-stadia